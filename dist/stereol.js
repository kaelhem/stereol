var t=function(t,r,n){return[t,r,n].map((function(t){return t.toExponential()}))},r=function(r,n){return"facet normal "+t.apply(void 0,r).join(" ")+"\n  outer loop\n    vertex "+t.apply(void 0,n[0]).join(" ")+"\n    vertex "+t.apply(void 0,n[1]).join(" ")+"\n    vertex "+t.apply(void 0,n[2]).join(" ")+"\n  endloop\nendfacet\n"},n=function(t){for(var r=t.split("\n").filter((function(t){return""!==t.trim()})),n=r[0],e=r.slice(1),i=[],o=0,a=!1;!a&&o<e.length&&-1===e[o].indexOf("endsolid");)(a=(a=(a=(a=(a=e.length<o+6)||-1===e[o].indexOf("normal "))||-1===e[o+2].indexOf("vertex "))||-1===e[o+3].indexOf("vertex "))||-1===e[o+4].indexOf("vertex "))||(i.push({normal:e[o].split("normal ")[1].trim().split(" ").map((function(t){return parseFloat(t)})),verts:[e[o+2].split("vertex ")[1].trim().split(" ").map((function(t){return parseFloat(t)})),e[o+3].split("vertex ")[1].trim().split(" ").map((function(t){return parseFloat(t)})),e[o+4].split("vertex ")[1].trim().split(" ").map((function(t){return parseFloat(t)}))]}),o+=7);if(a)throw new Error("This file is not formatted correctly.");return{description:n.slice(6),facets:i}},e=function(t,r){return void 0===r&&(r=255),Math.max(0,Math.min(r,parseInt(t,10)))},i=function(t){return e(t,31).toString(2).padStart(5,"0")},o=function(t){return e(t).toString(2).padStart(8,"0")},a=function(t){var r=t[0],n=t[1];return Number("0b"+i(t[2])+i(n)+i(r)+"1")},u=function(t){var r=t[1],n=t[2],e=t[3];return Number("0b"+o(t[0])+o(r)+o(n)+o(e))},l=void 0;try{l=Boolean(Buffer)}catch(t){l=!1}var f=function(t,r,n){switch(void 0===n&&(n=0),r){case"uint8":return l?t.readUInt8(n):t.getUint8(n);case"uint16":return l?t.readUInt16LE(n):t.getUint16(n,!0);case"uint32":return l?t.readUInt32LE(n):t.getUint32(n,!0);case"float":return l?t.readFloatLE(n):t.getFloat32(n,!0);default:throw new Error("No type specified")}},s=function(t){return(new TextDecoder).decode(t)};module.exports={exportStl:function(t,n){void 0===n&&(n={});var e=n.description,i=void 0===e?"":e,o=n.binary,f=n.color,s=void 0===f?null:f,c=n.material,d=void 0===c?null:c;if(void 0===o||o){var p=Array.isArray(s)&&4===s.length?s:null,v=p&&Array.isArray(d)&&3===d.length?d:null;if(v){var g=d[0],y=d[1],m=d[2];v=(v=(v=v&&Array.isArray(g)&&3===g.length?d:null)&&Array.isArray(y)&&3===y.length?d:null)&&Array.isArray(m)&&3===m.length?d:null}return function(t,r,n,e){var i=t.length,o=function(t){var r=l?Buffer.alloc(t):new DataView(new ArrayBuffer(t));return l&&r.fill(0,0,80),{writeBuffer:function(t,n,e){switch(void 0===e&&(e=0),t){case"uint8":return l?r.writeUInt8(n,e):r.setUint8(e,n);case"uint16":return l?r.writeUInt16LE(n,e):r.setUint16(e,n,!0);case"uint32":return l?r.writeUInt32LE(n,e):r.setUint32(e,n,!0);case"float":return l?r.writeFloatLE(n,e):r.setFloat32(e,n,!0);case"string":return l?r.write(n,e):function(t,r,n){void 0===r&&(r=""),void 0===n&&(n=0);var e=0;r.split("").forEach((function(r){t.setUint8(n+e,r.charCodeAt(0)),++e}))}(r,n,e);default:throw new Error("No type specified")}},getBuffer:function(){return l?r:r.buffer}}}(84+12*i*4+2*i),f=o.writeBuffer,s=o.getBuffer;if(f("string",r),n){f("string"," COLOR=",47);var c=n[1],d=n[2],p=n[3];if(f("uint8",n[0],54),f("uint8",c,55),f("uint8",d,56),f("uint8",p,57),e){f("string",",MATERIAL=",58);var v=e[1],g=e[2];f("uint32",u(e[0]),68),f("uint32",u(v),72),f("uint32",u(g),76)}}f("uint32",i,80);for(var y=84,m=function(t){f("float",t,y),y+=4},h=0;h<t.length;h++){var x=t[h],w=x.normal||computeNormal(x.verts);m(w[0]),m(w[1]),m(w[2]);for(var A=0;A<x.verts.length;A++){var E=x.verts[A];m(E[0]),m(E[1]),m(E[2])}var O=x.color?a(x.color):0;f("uint16",O,y),y+=2}return s()}(t,i,p,v)}return function(t,n){void 0===n&&(n="");for(var e="solid "+n.split(" COLOR=")[0].trim()+"\n",i=0;i<t.length;i++){var o=t[i],a=o.verts,u=o.normal||computeNormal(a);e+=r(u,a)}return e+"endsolid"}(t,i)},importStl:function(t){return"string"==typeof t&&"solid "===t.slice(0,6)?(console.log("type: ascii string"),n(t)):"undefined"!=typeof TextEncoder&&"object"==typeof t&&"solid "===s(t.slice(0,6))?(console.log("type: ascii string in ArrayBuffer (browser only)"),n(s(t))):"undefined"==typeof TextEncoder&&"object"==typeof t&&"solid "===t.toString().slice(0,6)?(console.log("type: ascii string in Buffer (nodeJS only)"),n(t.toString())):(console.log("type: binary buffer"),function(t){for(var r=l?Buffer.from(t):new DataView(t),n=[],e=0;e<80;++e)n.push(f(r,"uint8",e));var i=String.fromCharCode.apply(String,n),o=i.indexOf(" COLOR="),a=null;-1!==o&&(a=[f(r,"uint8",o+7),f(r,"uint8",o+8),f(r,"uint8",o+9),f(r,"uint8",o+10)]);var u=null;-1!==i.indexOf("MATERIAL=")&&(u=[f(r,"uint32",o+9),f(r,"uint32",o+13),f(r,"uint32",o+17)]);for(var s=[],c=f(r,"uint32",80),d=84,p=function(){return f(r,"float",(d+=4)-4)},v=0;v<c;++v){var g=[p(),p(),p()],y=[[p(),p(),p()],[p(),p(),p()],[p(),p(),p()]],m=f(r,"uint16",d);d+=2,s.push({normal:g,verts:y,color:m})}return{description:i,facets:s,color:a,material:u}}(t))}};
//# sourceMappingURL=stereol.js.map
